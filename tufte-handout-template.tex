\documentclass[
a4paper
]{tufte-handout}

%===============================================================================
%                                 Preamble                                     %
%===============================================================================

% %===========%
% %   Fonts   %
% %===========%
% 
% \usepackage[T1]{fontenc} % For more font encoding options
% \usepackage{lmodern} % For better quality fonts
% \usepackage[normalem]{ulem} % For underlining (use \uline{...})
% 
% 

\usepackage{booktabs} % Better quality tables.
\usepackage{multirow} % Tabular cells spanning multiple rows
\usepackage{pbox} % Intelligent variable width parboxes
% \usepackage[font=small, labelfont=bf]{caption} % Caption formatting

\renewcommand\refname{References} % Change the name of the bibliography

% % My preferred formatting of the quote environment
% \renewenvironment{quote}
%                {\list{}{\rightmargin\leftmargin}%
%                 \item\relax\small}
%                {\endlist}

\frenchspacing % Single spacing after periods
%============================%
%   Graphics and diagrams    %
%============================%

\usepackage{graphicx}
\usepackage[dvipsnames]{xcolor} % for handling colours; allows referring to them by name


%====================%
%   TikZ settings    %
%====================%

\usepackage{tikz}
\usetikzlibrary{positioning,tikzmark,calc,arrows.meta}


\usepackage{graphicx} % allow embedded images
  \setkeys{Gin}{width=\linewidth,totalheight=\textheight,keepaspectratio}

%=============%
%   Symbols   %
%=============%

\usepackage{latexsym,amsmath,amssymb,wasysym}
% Also loads amsfonts.
\usepackage{marvosym} % Provies \MVAt
\usepackage{phonetic} % For \riota (turned iota)
\usepackage{centernot} % Properly centres \not command on following argument
\usepackage{mathtools} % Provides \coloneqq
\usepackage{stmaryrd} % Various symbols including semantic interpretation brackets \llbracket and \rrbracket
\usepackage{units}    % non-stacked fractions and better unit spacing


% %=================%
% %   Bibliography  %
% %=================%
% 
% \usepackage{natbib} % Author-year citations
% \bibpunct{(}{)}{;}{a}{}{,}
% \setcitestyle{notesep={:\ }} % Changes separator between year and page to colon
% 
% 
\bibpunct{(}{)}{;}{a}{}{,}
\setcitestyle{notesep={:\ }} % Changes separator between year and page to colon

% %==============%
% %  Hyperlinks  %
% %==============%
% 
% \usepackage[breaklinks,hidelinks]{hyperref} % hidelinks avoids boxes around links
% \urlstyle{rm} % tt,rm,sf,same
% \definecolor{hlinkcolor}{rgb}{.0,.2,.4} % A nice dark blue
% %
% \hypersetup{%
% colorlinks=true,%
% urlcolor=hlinkcolor,%
% linkcolor = black,% For internal links
% citecolor = black% For citation links
% }
% 
%==================%
%   Linguistics    %
%==================%

% IPA
\usepackage{tipa}

% OT tableaux
% \usepackage[round, medium]{OTtablx}		%For OT tableaux.
% \usepackage{pifont} % for pointing hand

% AVMs
\usepackage{avm}
\avmfont{\sc}
% \avmoptions{active} % Avoid having to type backslashes before every square bracket, but with limitations (e.g. doesn't work when the avm environment is inside the argument of another command)

% Numbered examples
\usepackage{linguex}
\let\eachwordtwo=\it % Italicises second line of gloss
\renewcommand{\firstrefdash}{} % Removes dash between example number and letter in references

% Proofs
\usepackage{prooftree}

% Syntax trees
% \usepackage{qtree}
% \qtreecenterfalse
\usepackage[linguistics]{forest}
\forestset{
default preamble={%
for tree={s sep=5mm, inner sep=1, l=0pt}}
    }


% Taken from https://groups.google.com/g/tufte-latex/c/7iKZHKKT5u0 -- adding this after linguex has been loaded will restore the Tufte-LaTeX definition of footnotes (as sidenotes) but adds in the two lines of code used by the gb4e package (via linguex).
\makeatletter
\renewcommand\@footnotetext[2][0pt]{%
  \@noftnotefalse\setcounter{fnx}{0}% added by gb4e
  \marginpar{%
    \hbox{}\vspace*{#1}%
    \def\baselinestretch {\setspace@singlespace}%
    \reset@font\footnotesize%
    \@tufte@margin@par% use parindent and parskip settings for marginal text
    \vspace*{-1\baselineskip}\noindent%
    \protected@edef\@currentlabel{%
       \csname p@footnote\endcsname\@thefnmark%
    }%
    \color@begingroup%
       \@makefntext{%
         \ignorespaces#2%
       }%
    \color@endgroup%
  }%
  \@noftnotetrue% added by g4be
}%
\makeatother
% End of linguex compatibility fix


\usepackage{lipsum}

%==========%
%  Macros  %
%==========%

\input{jyf-macros}

%===========%
%   Title   %
%===========%

\title{Title of the handout}
\author{Jamie Y. Findlay\\\small University of Oslo\\\small\email{jamie.findlay@iln.uio.no}}
\date{}

%===============================================================================
%                               Document start                                 %
%===============================================================================

\begin{document}

\maketitle

\begin{abstract}%
This is an abstract: \lipsum[1]
\end{abstract}

\section{Section}

\newthought{According to Tufte,} this is how you start new thoughts \dots.\footnote{Here's a footnote appearing in the margin.}
And here's an example of a reference appearing in the margin.\cite{findlay:lmt}

\lipsum[2] \marginnote[-10ex]{We can have notes appearing in the margin that aren't numbered.}

\begin{marginfigure}
  \centering
\begin{forest}
[S [NP [Jules] ] [VP [V [laughed]]]]
\end{forest}
\caption{Here's a syntax tree in the margin}
\end{marginfigure}

%===================%
%   Bibliography    %
%===================%

\bibliographystyle{jyf-sp} % My modified version of the Semantics & Pragmatics bibliography style
\bibliography{linguistics}

\end{document}
